<div class="board-header">
  <h1><p>d</p> The d company</h1>
  <div class="filter-bar">
    <div class="filter-title">Filters:</div>
    <mat-form-field appearance="fill">
      <mat-label>Select person</mat-label>
      <mat-select [(ngModel)]="assignedToFilter" (selectionChange)="applyAssignedToFilter()" disableRipple>
        <mat-option value="">All</mat-option>
        <mat-option value="Dimitar P.">Dimitar P.</mat-option>
        <mat-option value="Boryana G.">Boryana G.</mat-option>
        <mat-option value="Atanas D.">Atanas D.</mat-option>
      </mat-select>
    </mat-form-field>
    <p>
      <mat-form-field appearance="fill">
        <mat-label>Estimation</mat-label>
        <input matInput [(ngModel)]="estimationFilter" (input)="applyEstimationFilter()" min="0">
      </mat-form-field>
    </p>
  </div>
  <div class="action-buttons">
    <a (click)="navigateToNewTask()">Create task +</a>
    @if (isLoggedIn()) {
      <a (click)="logout()">Logout</a>
    } @else {
      <a [routerLink]="['/login']">Login</a>
    }
  </div>
</div>
<div class="board" cdkDropListGroup>
  <div class="card">
    <h2>To Do</h2>
    <div class="tasksContainer" cdkDropList [cdkDropListData]="filteredToDoList" (cdkDropListDropped)="drop($event, 'to-do')">
      @for (task of filteredToDoList; track task.id) {
        <div class="task" (click)="openTask(task.id)" cdkDrag>
          <p>{{ task.title }}</p>
          <p>{{ task.assignedTo || 'Unassigned' }}</p>
          <p>{{ task.estimation || '' }}</p>
        </div>
      } @empty {
        <div class="task">No tasks</div>
      }
    </div>
  </div>
  <div class="card">
    <h2>In progress</h2>
    <div class="tasksContainer" cdkDropList [cdkDropListData]="filteredInProgressList" (cdkDropListDropped)="drop($event, 'in-progress')">
      @for (task of filteredInProgressList; track task.id) {
        <div class="task" (click)="openTask(task.id)" cdkDrag>
          <p>{{ task.title }}</p>
          <p>{{ task.assignedTo || 'Unassigned' }}</p>
          <p>{{ task.estimation || '' }}</p>
        </div>
      } @empty {
        <div class="task">No tasks</div>
      }
    </div>
  </div>
  <div class="card">
    <h2>Done</h2>
    <div class="tasksContainer" cdkDropList [cdkDropListData]="filteredDoneList" (cdkDropListDropped)="drop($event, 'done')">
      @for (task of filteredDoneList; track task.id) {
        <div class="task" (click)="openTask(task.id)" cdkDrag>
          <p>{{ task.title }}</p>
          <p>{{ task.assignedTo || 'Unassigned' }}</p>
          <p>{{ task.estimation || '' }}</p>
        </div>
      } @empty {
        <div class="task">No tasks</div>
      }
    </div>
  </div>
</div>
