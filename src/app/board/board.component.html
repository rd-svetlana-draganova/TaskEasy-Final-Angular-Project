<div class="board-header">
  <h1><p>d</p> The d company</h1>
  <div class="filter-bar">
    <div class="filter-title">Filters:</div>
    <select [(ngModel)]="assignedToFilter" (change)="applyAssignedToFilter()">
      <option value="" disabled selected hidden>Select person</option>
      <option value="">All</option>
      <option value="Dimitar P.">Dimitar P.</option>
      <option value="Boryana G.">Boryana G.</option>
      <option value="Atanas D.">Atanas D.</option>
    </select>
    <input [(ngModel)]="estimationFilter" (input)="applyEstimationFilter()" min="0" placeholder="Estimation"/>
  </div>
  <div class="action-buttons">
    <a (click)="navigateToNewTask()">Create task +</a>
    @if (isLoggedIn()) {
      <a (click)="logout()">Logout</a>
    } @else {
      <a [routerLink]="['/login']">Login</a>
    }
  </div>
</div>
<div class="board" cdkDropListGroup>
  <div class="card">
    <h2>To Do</h2>
    <div class="tasksContainer" cdkDropList [cdkDropListData]="filteredToDoList" (cdkDropListDropped)="drop($event, 'to-do')">
      @for (task of filteredToDoList; track task.id) {
        <div class="task" (click)="openTask(task.id)" cdkDrag>
          <p>{{ task.title }}</p>
          <p>{{ task.assignedTo || 'Unassigned' }}</p>
          <p>{{ task.estimation || '' }}</p>
        </div>
      } @empty {
        <div class="task">No tasks</div>
      }
    </div>
  </div>
  <div class="card">
    <h2>In progress</h2>
    <div class="tasksContainer" cdkDropList [cdkDropListData]="filteredInProgressList" (cdkDropListDropped)="drop($event, 'in-progress')">
      @for (task of filteredInProgressList; track task.id) {
        <div class="task" (click)="openTask(task.id)" cdkDrag>
          <p>{{ task.title }}</p>
          <p>{{ task.assignedTo || 'Unassigned' }}</p>
          <p>{{ task.estimation || '' }}</p>
        </div>
      } @empty {
        <div class="task">No tasks</div>
      }
    </div>
  </div>
  <div class="card">
    <h2>Done</h2>
    <div class="tasksContainer" cdkDropList [cdkDropListData]="filteredDoneList" (cdkDropListDropped)="drop($event, 'done')">
      @for (task of filteredDoneList; track task.id) {
        <div class="task" (click)="openTask(task.id)" cdkDrag>
          <p>{{ task.title }}</p>
          <p>{{ task.assignedTo || 'Unassigned' }}</p>
          <p>{{ task.estimation || '' }}</p>
        </div>
      } @empty {
        <div class="task">No tasks</div>
      }
    </div>
  </div>
</div>
